<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
        <script src="https://kit.fontawesome.com/c39d0aac49.js" crossorigin="anonymous"></script>
        {% if is_production %}
        <link rel="stylesheet" href="{{ url_for('static',filename='node/dist/css/main.min.css') }}" media="screen">
        {% endif %}
        <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@splidejs/splide@4.1.4/dist/css/splide.min.css">
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto+Condensed:700">
        <link rel="icon" href="data:,">
        <script src="https://cdn.jsdelivr.net/npm/@splidejs/splide@4.1.4/dist/js/splide.min.js"></script>
        <script src="https://unpkg.com/peerjs@1.5.1/dist/peerjs.min.js"></script>
        <title>
            {% block title %}Log Base{% endblock %}
        </title>
    </head>
    <body id="body">
        <div id="loading"><div class="loader"></div></div>
        {% block layout %}{% endblock %}
        <div id="overlay" class="toggler"></div>

        {% if g.user %}
        <input type="hidden" id="user-name" value="{{ g.user.name }}">
        {% endif %}

        <script src="/static/node/dist/ignored/js/variable.js"></script>

        <img id="heicimg" style="display: none;" src="{{ url_for('static', filename='/node/dist/ignored/js/sample1.heic') }}" alt="">

        {% if is_production %}
        <script src="/static/node/dist/js/main.min.js"></script>
        {% else %}
        <script src="/static/node/dist/js/main.js"></script>
        {% endif %}

        <script>
            const setFillHeight = async (is_focus_related=false) => {
                if (is_focus_related) {
                    await new Promise((resolve) => {
                        setTimeout(resolve, 400)
                    });
                }
                const vh = visualViewport.height;
                document.documentElement.style.setProperty('--vh', `${vh}px`);
                console.log(vh);
            }

            // (SP・TAB) 画面を横側に傾けリサイズした際
            let vw = window.innerWidth;

            window.addEventListener('resize', () => {
                // 画面の横幅にサイズ変動がないので処理を終了
                if (vw === window.innerWidth) return;
                // 画面の横幅のサイズ変動があった時のみ高さを再計算
                vw = window.innerWidth;
                setFillHeight();
            });

            // メッセージテキストエリアのフォーカス時・フォーカス解除時
            const MSG_TXTAREA = get_element('#add-message--content');

            if (typeof MSG_TXTAREA != 'undefined') {
                // フォーカス時、キーボードを除くデバイス高さを設定します
                MSG_TXTAREA.addEventListener('focus', () => setFillHeight(true));
                // フォーカス解除時、アドレスバーを除くデバイス高さを設定します
                MSG_TXTAREA.onblur = () => setFillHeight(true);
            }

            // 初期化
            setFillHeight();
        </script>
    </body>
</html>
