<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <script src="https://kit.fontawesome.com/c39d0aac49.js" crossorigin="anonymous"></script>
        <link rel="stylesheet" href="{{ url_for('static',filename='node/dist/css/main.min.css') }}" media="screen">
        <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@splidejs/splide@4.1.4/dist/css/splide.min.css">
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto+Condensed:700">
        <script src="https://cdn.jsdelivr.net/npm/@splidejs/splide@4.1.4/dist/js/splide.min.js"></script>
        <script src="https://unpkg.com/peerjs@1.5.1/dist/peerjs.min.js"></script>
        <title>
            {% block title %}Log Base{% endblock %}
        </title>
    </head>
    <body id="body">
        <script>
        </script>
        <div id="loading"><div class="loader"></div></div>
        {% block layout %}
        {% endblock %}
        <div id="overlay" class="toggler"></div>
        {% if g.user %}
            <input type="hidden" id="user-name" value="{{ g.user.name }}">
        {% endif %}
        <script src="/static/node/dist/ignored/js/variable.js"></script>
        <script src="/static/node/dist/js/main.js"></script>
        <script src="/static/node/dist/js/main.min.js"></script>
        <script>
            stream_video = () => {
                const video = document.getElementById('side-caller-video');
                const video2 = document.getElementById('full-caller-video');
                navigator.mediaDevices
                    .getUserMedia({
                        video: true,
                        audio: false,
                    })
                    .then((stream) => {
                        video.srcObject = stream;
                        video.play();
                        video2.srcObject = stream;
                        video2.play();
                    })
                    .catch((e) => {
                        console.log(e);
                    });
            }

            let go_btn = document.getElementById('video-go');
            if (go_btn) go_btn.addEventListener('click', stream_video);


            const PEER = new Peer();

            // Connect
            const CONN = PEER.connect('another-peers-id');
            // on open will be launch when you successfully connect to PeerServer
            PEER.on('open', function(){
                // here you have conn.id
                PEER.send('hi!');
            });

            // Receive
            PEER.on('connection', function(conn) {
                conn.on('data', function(data){
                    // Will print 'hi!'
                    console.log(data);
                });
            });
        </script>
    </body>
</html>